<?php declare(strict_types=1);

namespace N189900\Wyhash;

use N189900\Wyhash\Exception\AlreadyFinalizedException;

/**
 * @coversDefaultClass \N189900\Wyhash\State
 */
class StateTest extends \PHPUnit\Framework\TestCase
{
    /**
     * @covers ::__construct
     */
    public function testConstructor(): void
    {
        $instance = new State();

        $this->assertNotEmpty($instance->final(''));
    }

    /**
     * @covers ::__construct
     */
    public function testDefaultSeed(): void
    {
        $default = new State();
        $zero = new State(State::DEFAULT_SEED);

        $this->assertSame($default->final(''), $zero->final(''));
    }

    /**
     * @covers ::__construct
     */
    public function testNonDefaultSeed(): void
    {
        $default = new State();
        $custom = new State('123');

        $this->assertNotSame($default->final(''), $custom->final(''));
    }

    /**
     * @dataProvider dataProviderPayloadShorterThanUpdateSize
     * @covers ::final
     */
    public function testPayloadFitsFinal(string $message, string $seed, string $expected): void
    {
        $state = new State($seed);

        $this->assertSame($expected, $state->final($message));
    }

    public function dataProviderPayloadShorterThanUpdateSize(): array
    {
        return [
            ['', '0x00', '42bc986dc5eec4d3'],
            ['z', '0x01', 'a314c70a8d48fce3'],
            ['zy', '0x02', 'a94f5047a0dcfe65'],
            ['zyx', '0x03', '0710dd747e33fecb'],
            ['zyxw', '0x04', '1f875bfb8cbfac35'],
            ['zyxwv', '0x05', '227b162c73c31c94'],
            ['zyxwvu', '0x06', '041e5a1fce6ac2d5'],
            ['zyxwvut', '0x07', '9da8fd67484fc653'],
            ['zyxwvuts', '0x08', '471442870fec5c4c'],
            ['zyxwvutsr', '0x09', '7f7fffe76cd26818'],
            ['zyxwvutsrq', '0x0a', 'c90c178b04ce16e3'],
            ['zyxwvutsrqp', '0x0b', '631d4b77486f1aa7'],
            ['zyxwvutsrqpo', '0x0c', '334843cc67b3e351'],
            ['zyxwvutsrqpon', '0x0d', '99091edc5deca3b7'],
            ['zyxwvutsrqponm', '0x0e', 'acf6a74fc9faaa71'],
            ['zyxwvutsrqponml', '0x0f', '2f5f5a36ec8b6553'],
            ['zyxwvutsrqponmlk', '0x10', '7f560d1c3fa5c437'],
            ['zyxwvutsrqponmlkj', '0x11', '10992693951b76d9'],
            ['zyxwvutsrqponmlkji', '0x12', '889935bb1b3e78fa'],
            ['zyxwvutsrqponmlkjih', '0x13', '124b5db50ab7b0b0'],
            ['zyxwvutsrqponmlkjihg', '0x14', '4be9271aa8e50936'],
            ['zyxwvutsrqponmlkjihgf', '0x15', '6bad65abdd1b9f70'],
            ['zyxwvutsrqponmlkjihgfe', '0x16', 'c3614af0129d1d23'],
            ['zyxwvutsrqponmlkjihgfed', '0x17', '3ab383fc0861c519'],
            ['zyxwvutsrqponmlkjihgfedc', '0x18', '2b20f74d25f60f5f'],
            ['zyxwvutsrqponmlkjihgfedcb', '0x19', 'c7811658fa5f9fae'],
            ['zyxwvutsrqponmlkjihgfedcba', '0x1a', '36c6a311760bebbf'],
            ['zyxwvutsrqponmlkjihgfedcbaz', '0x1b', 'c5f4e29c4fd1c9c6'],
            ['zyxwvutsrqponmlkjihgfedcbazy', '0x1c', 'c48081cbcfadf37e'],
            ['zyxwvutsrqponmlkjihgfedcbazyx', '0x1d', 'df408e81975612ae'],
            ['zyxwvutsrqponmlkjihgfedcbazyxw', '0x1e', '2170b23a9b8e84fa'],
            ['zyxwvutsrqponmlkjihgfedcbazyxwv', '0x1f', '4f1b43499761c556'],
            ['zyxwvutsrqponmlkjihgfedcbazyxwvu', '0x20', '058c1e0c2846f513'],
            ['zyxwvutsrqponmlkjihgfedcbazyxwvut', '0x21', '09df42c549002901'],
            ['zyxwvutsrqponmlkjihgfedcbazyxwvuts', '0x22', '962e45c7c722d524'],
            ['zyxwvutsrqponmlkjihgfedcbazyxwvutsr', '0x23', '1d1a705fe4df05f5'],
            ['zyxwvutsrqponmlkjihgfedcbazyxwvutsrq', '0x24', 'abd968550c64c7ee'],
            ['zyxwvutsrqponmlkjihgfedcbazyxwvutsrqp', '0x25', '34df7e784b3abe3c'],
            ['zyxwvutsrqponmlkjihgfedcbazyxwvutsrqpo', '0x26', 'e911a2fad79ed6d1'],
            ['zyxwvutsrqponmlkjihgfedcbazyxwvutsrqpon', '0x27', 'b588095509d06e75'],
            ['zyxwvutsrqponmlkjihgfedcbazyxwvutsrqponm', '0x28', 'd04d6a66da945074'],
            ['zyxwvutsrqponmlkjihgfedcbazyxwvutsrqponml', '0x29', 'b0ed6caca6a2b631'],
            ['zyxwvutsrqponmlkjihgfedcbazyxwvutsrqponmlk', '0x2a', '8c8bb605ae2513e4'],
            ['zyxwvutsrqponmlkjihgfedcbazyxwvutsrqponmlkj', '0x2b', '307e8671834cfc26'],
            ['zyxwvutsrqponmlkjihgfedcbazyxwvutsrqponmlkji', '0x2c', '2b55d70830a41c50'],
            ['zyxwvutsrqponmlkjihgfedcbazyxwvutsrqponmlkjih', '0x2d', '14509f08ca4ab0fd'],
            ['zyxwvutsrqponmlkjihgfedcbazyxwvutsrqponmlkjihg', '0x2e', '3863f5e0deaec8ec'],
            ['zyxwvutsrqponmlkjihgfedcbazyxwvutsrqponmlkjihgf', '0x2f', '1610afcd161a5980'],
            ['zyxwvutsrqponmlkjihgfedcbazyxwvutsrqponmlkjihgfe', '0x30', '0db3ab5c6fd4b14b'],
            ['zyxwvutsrqponmlkjihgfedcbazyxwvutsrqponmlkjihgfed', '0x31', '2de1da8e6c6d477d'],
            ['zyxwvutsrqponmlkjihgfedcbazyxwvutsrqponmlkjihgfedc', '0x32', '24e65c22fae0a469'],
            ['zyxwvutsrqponmlkjihgfedcbazyxwvutsrqponmlkjihgfedcb', '0x33', '70d777023d025781'],
            ['zyxwvutsrqponmlkjihgfedcbazyxwvutsrqponmlkjihgfedcba', '0x34', 'bb9e054b602f4575'],
            ['zyxwvutsrqponmlkjihgfedcbazyxwvutsrqponmlkjihgfedcbaz', '0x35', 'e7f40b6d0283ba51'],
            ['zyxwvutsrqponmlkjihgfedcbazyxwvutsrqponmlkjihgfedcbazy', '0x36', '471f9cbb62534719'],
            ['zyxwvutsrqponmlkjihgfedcbazyxwvutsrqponmlkjihgfedcbazyx', '0x37', 'e1c03f9b914bb3be'],
            ['zyxwvutsrqponmlkjihgfedcbazyxwvutsrqponmlkjihgfedcbazyxw', '0x38', '323846b3f29a4695'],
            ['zyxwvutsrqponmlkjihgfedcbazyxwvutsrqponmlkjihgfedcbazyxwv', '0x39', 'f50878f23cefaf0a'],
            ['zyxwvutsrqponmlkjihgfedcbazyxwvutsrqponmlkjihgfedcbazyxwvu', '0x3a', '76c796eb3e269d9e'],
            ['zyxwvutsrqponmlkjihgfedcbazyxwvutsrqponmlkjihgfedcbazyxwvut', '0x3b', '74780f6cca2f779b'],
            ['zyxwvutsrqponmlkjihgfedcbazyxwvutsrqponmlkjihgfedcbazyxwvuts', '0x3c', '372b744ef436e3c0'],
            ['zyxwvutsrqponmlkjihgfedcbazyxwvutsrqponmlkjihgfedcbazyxwvutsr', '0x3d', '9373ec712dead812'],
            ['zyxwvutsrqponmlkjihgfedcbazyxwvutsrqponmlkjihgfedcbazyxwvutsrq', '0x3e', '4cf60276658dfbd3'],
            ['zyxwvutsrqponmlkjihgfedcbazyxwvutsrqponmlkjihgfedcbazyxwvutsrqp', '0x3f', 'cddba2ee58e6c402'],
        ];
    }

    /**
     * @dataProvider dataProviderUpdateZeroTail
     * @dataProvider dataProviderUpdateSixteenByteTail
     * @dataProvider dataProviderUpdateThirtyTwoByteTail
     * @covers ::update
     */
    public function testUpdateWithTail(string $message, string $seed, string $expected): void
    {
        $state = new State($seed);
        $chunks = str_split($message, State::UPDATE_SIZE);
        $tail = array_pop($chunks);

        foreach ($chunks as $chunk) {
            $state->update($chunk);
        }

        $this->assertSame($expected, $state->final($tail));
    }

    public function dataProviderUpdateZeroTail(): array
    {
        return [
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlkz', '0x0', 'd313754979ce56dd'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzy', '0x0', '5087c782ff126e6f'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyx', '0x0', '7e194a007533841a'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxw', '0x0', '7c94d67110b5bd67'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwv', '0x0', 'e3a678122779bd5f'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvu', '0x0', 'e0d223cd7f1b2d70'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvut', '0x0', 'e18dac8f51079806'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvuts', '0x0', 'b34f96561de170c1'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsr', '0x0', 'f802566dced522fd'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrq', '0x0', 'c16e141ff9ed0e45'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqp', '0x0', '5d2e0dd7eddecb37'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqpo', '0x0', '4e169dfbf22eac19'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqpon', '0x0', '3ed24d3a383819d4'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponm', '0x0', 'e0975d2fccf598ca'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponml', '0x0', '46129b07ebf6cdde'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlk', '0x0', '9735b53f4b4fae27'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkj', '0x0', 'de388a44dbd558b0'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkji', '0x0', '13edf0a47bda6e80'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjih', '0x0', '525f5e19c7eac80b'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihg', '0x0', '27e8656863df7a7e'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihgf', '0x0', '7071eeaf454ac748'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihgfe', '0x0', '58a328938f736464'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihgfed', '0x0', 'f4dfa1addffe6cd8'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihgfedc', '0x0', 'fe07290f21b7eaad'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihgfedcb', '0x0', 'cf70d2cdef669fca'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihgfedcba', '0x0', '56da03d9bab1ad76'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihgfedcbaz', '0x0', '272e68f9f7de76be'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihgfedcbazy', '0x0', '8aa45babc7aa1ca4'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihgfedcbazyx', '0x0', 'a1d8c57837898e48'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihgfedcbazyxw', '0x0', '9e7f9b3d7d33f62e'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihgfedcbazyxwv', '0x0', '795ed779f2a6e524'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihgfedcbazyxwvu', '0x0', '351bcbb963deb588'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihgfedcbazyxwvut', '0x0', '994c9f62dc609a9b'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihgfedcbazyxwvuts', '0x0', '821ad377f51cbdc1'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihgfedcbazyxwvutsr', '0x0', 'f1400f7fac29cb06'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihgfedcbazyxwvutsrq', '0x0', 'a8f24c75c35c101e'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihgfedcbazyxwvutsrqp', '0x0', '9215cd4bed1ff330'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihgfedcbazyxwvutsrqpo', '0x0', 'd1f7feebb582de3f'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihgfedcbazyxwvutsrqpon', '0x0', 'bbcf79662e2f3538'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihgfedcbazyxwvutsrqponm', '0x0', '5e8df9817b251414'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihgfedcbazyxwvutsrqponml', '0x0', 'cffe2b9fb13faf9d'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihgfedcbazyxwvutsrqponmlk', '0x0', '753dcebd343de2e0'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihgfedcbazyxwvutsrqponmlkj', '0x0', '131b3ad424fde649'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihgfedcbazyxwvutsrqponmlkji', '0x0', '61beaa86906603cc'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihgfedcbazyxwvutsrqponmlkjih', '0x0', '2edcaa8cf8d1e8ec'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihgfedcbazyxwvutsrqponmlkjihg', '0x0', '6df399e80ce63415'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihgfedcbazyxwvutsrqponmlkjihgf', '0x0', 'a9101de4c02636f2'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihgfedcbazyxwvutsrqponmlkjihgfe', '0x0', '5b3e739e84c97136'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihgfedcbazyxwvutsrqponmlkjihgfed', '0x0', '65ac51c07d60a79f'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihgfedcbazyxwvutsrqponmlkjihgfedc', '0x0', '8949add219ef6de9'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihgfedcbazyxwvutsrqponmlkjihgfedcb', '0x0', '395b4dfd6936151d'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihgfedcbazyxwvutsrqponmlkjihgfedcba', '0x0', '9188fab8d8f6652e'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihgfedcbazyxwvutsrqponmlkjihgfedcbaz', '0x0', 'ccef446051c0fea6'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihgfedcbazyxwvutsrqponmlkjihgfedcbazy', '0x0', '7b89432114d7bbd8'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihgfedcbazyxwvutsrqponmlkjihgfedcbazyx', '0x0', '0741786113bb049a'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihgfedcbazyxwvutsrqponmlkjihgfedcbazyxw', '0x0', '9b604a47ed39e770'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihgfedcbazyxwvutsrqponmlkjihgfedcbazyxwv', '0x0', '18af7578595f5b31'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihgfedcbazyxwvutsrqponmlkjihgfedcbazyxwvu', '0x0', 'd595c7731ef91cc8'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihgfedcbazyxwvutsrqponmlkjihgfedcbazyxwvut', '0x0', 'fd5766b051521dbe'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihgfedcbazyxwvutsrqponmlkjihgfedcbazyxwvuts', '0x0', '204f0d24f7fbebb5'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihgfedcbazyxwvutsrqponmlkjihgfedcbazyxwvutsr', '0x0', '6849933672350512'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihgfedcbazyxwvutsrqponmlkjihgfedcbazyxwvutsrq', '0x0', '5841e883a4ad06a7'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihgfedcbazyxwvutsrqponmlkjihgfedcbazyxwvutsrqp', '0x0', 'b0cb207328399d7e'],
        ];
    }

    public function dataProviderUpdateSixteenByteTail(): array
    {
        return [
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlkz', '0x10', '3ba12188dd5cbbf6'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzy', '0x10', '53af1dfdc28145fa'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyx', '0x10', 'dc2490e15f286e48'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxw', '0x10', 'b115dd713ea87670'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwv', '0x10', 'e62a3d71fd9ff03c'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvu', '0x10', 'dae00a38b7165170'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvut', '0x10', '67b23fdf99976a9e'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvuts', '0x10', '070bc6d2df7da994'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsr', '0x10', 'ac157b30ac04b8da'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrq', '0x10', '87641e0d0a22102b'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqp', '0x10', '2230bd110d6d60df'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqpo', '0x10', 'bb408cd52ce7cd4d'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqpon', '0x10', '6cce682f93f483d3'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponm', '0x10', '51a4657909d2beb4'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponml', '0x10', '87973f251e62924b'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlk', '0x10', '341392b26bf5c1fd'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkj', '0x10', 'e28d77b5962afc93'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkji', '0x10', 'bfcbf27c5010db11'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjih', '0x10', '5ced3cd5bd5fe734'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihg', '0x10', '43ea691b678b5835'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihgf', '0x10', 'e7da478b728f27d9'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihgfe', '0x10', '48f8e4c2d7eb5c09'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihgfed', '0x10', '1e625ebec1513670'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihgfedc', '0x10', 'a5497aee6e917a6f'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihgfedcb', '0x10', '5466fbaeb2d0dd9a'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihgfedcba', '0x10', '41719d21a1b5d10c'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihgfedcbaz', '0x10', '101222cbb144d3f0'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihgfedcbazy', '0x10', 'ed9ba52a63313928'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihgfedcbazyx', '0x10', '67d649e498706f8e'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihgfedcbazyxw', '0x10', '17d24caacd98d618'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihgfedcbazyxwv', '0x10', '459bdafc1af2c4a6'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihgfedcbazyxwvu', '0x10', '4f29e359f62179c2'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihgfedcbazyxwvut', '0x10', '018e05697ee59b42'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihgfedcbazyxwvuts', '0x10', '8aeb1edf3ba7de34'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihgfedcbazyxwvutsr', '0x10', '88c1fbcd9bb6fc30'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihgfedcbazyxwvutsrq', '0x10', 'cc3c1472437bda8f'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihgfedcbazyxwvutsrqp', '0x10', '4b21071765032417'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihgfedcbazyxwvutsrqpo', '0x10', '0e7826cc23c3b63e'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihgfedcbazyxwvutsrqpon', '0x10', '0bb54420c45e9236'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihgfedcbazyxwvutsrqponm', '0x10', 'dd27ffc0642c3e9f'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihgfedcbazyxwvutsrqponml', '0x10', 'c8e99686a862c553'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihgfedcbazyxwvutsrqponmlk', '0x10', '20698ecb0726b5bd'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihgfedcbazyxwvutsrqponmlkj', '0x10', 'a822615360073504'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihgfedcbazyxwvutsrqponmlkji', '0x10', '29ba6cdba3897865'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihgfedcbazyxwvutsrqponmlkjih', '0x10', 'e73f3a99e301f197'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihgfedcbazyxwvutsrqponmlkjihg', '0x10', '60e127506023f9c5'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihgfedcbazyxwvutsrqponmlkjihgf', '0x10', 'f64ffdac3e718cc3'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihgfedcbazyxwvutsrqponmlkjihgfe', '0x10', '1105d03acb67a730'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihgfedcbazyxwvutsrqponmlkjihgfed', '0x10', '47c40cf8b9625159'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihgfedcbazyxwvutsrqponmlkjihgfedc', '0x10', '81a12334c5516a82'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihgfedcbazyxwvutsrqponmlkjihgfedcb', '0x10', '3caad70e025a754e'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihgfedcbazyxwvutsrqponmlkjihgfedcba', '0x10', '9a237bf44fb76b5f'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihgfedcbazyxwvutsrqponmlkjihgfedcbaz', '0x10', '37d6253d331543ac'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihgfedcbazyxwvutsrqponmlkjihgfedcbazy', '0x10', 'e3822eaba0409af6'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihgfedcbazyxwvutsrqponmlkjihgfedcbazyx', '0x10', 'af857fb8bbf5a024'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihgfedcbazyxwvutsrqponmlkjihgfedcbazyxw', '0x10', '2378ead23750a81c'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihgfedcbazyxwvutsrqponmlkjihgfedcbazyxwv', '0x10', 'c9e2884a8b88ec6a'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihgfedcbazyxwvutsrqponmlkjihgfedcbazyxwvu', '0x10', '92dca1d0ffc6b730'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihgfedcbazyxwvutsrqponmlkjihgfedcbazyxwvut', '0x10', 'cb996e51d31cae97'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihgfedcbazyxwvutsrqponmlkjihgfedcbazyxwvuts', '0x10', 'bcc8d371770edb9f'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihgfedcbazyxwvutsrqponmlkjihgfedcbazyxwvutsr', '0x10', '23a34d0a6df4bd30'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihgfedcbazyxwvutsrqponmlkjihgfedcbazyxwvutsrq', '0x10', '91906f06719e2fe4'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihgfedcbazyxwvutsrqponmlkjihgfedcbazyxwvutsrqp', '0x10', 'aadcdba45c7b6748'],
        ];
    }

    public function dataProviderUpdateThirtyTwoByteTail(): array
    {
        return [
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlkz', '0x20', 'f037279222fcd839'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzy', '0x20', '0a2a6c7bfd939adc'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyx', '0x20', 'ea4b0b05245fbdb0'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxw', '0x20', '709aabe4f0728fbd'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwv', '0x20', 'cbb4eecd5215da05'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvu', '0x20', 'fbccfdc71fad4b56'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvut', '0x20', '1f214ba0390e494e'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvuts', '0x20', '86775d9632ebdb9a'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsr', '0x20', 'afc6e0890d7fd331'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrq', '0x20', '37db5e0f72ad3f6e'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqp', '0x20', '1026452aab96c2f9'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqpo', '0x20', 'c05f49f449b56269'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqpon', '0x20', '488100d6acddf732'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponm', '0x20', '2fe78bd98f557e01'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponml', '0x20', '53468f2609cd16b2'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlk', '0x20', 'df8703128c00ffc0'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkj', '0x20', 'a4c4215b9ed7b81a'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkji', '0x20', '691989adc56500bf'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjih', '0x20', 'fa063256d4d8ea6c'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihg', '0x20', 'f0e4650c02c87ddf'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihgf', '0x20', 'f71e841d2379d5d0'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihgfe', '0x20', '205a6c2c3a126215'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihgfed', '0x20', '71090a1a3a5d45ed'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihgfedc', '0x20', 'eb33176b54e7dcc3'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihgfedcb', '0x20', '6414884bf1efc629'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihgfedcba', '0x20', '19031a8077c5008c'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihgfedcbaz', '0x20', 'b8f96676cbab3df5'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihgfedcbazy', '0x20', '120c23bcb8e48932'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihgfedcbazyx', '0x20', 'd898e3712a4e4d67'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihgfedcbazyxw', '0x20', 'd82358b14cfcee9b'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihgfedcbazyxwv', '0x20', '518fbf642b318f71'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihgfedcbazyxwvu', '0x20', '11ad02e02ae24306'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihgfedcbazyxwvut', '0x20', '52097623ee240dfe'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihgfedcbazyxwvuts', '0x20', '9b1da84ef8bbedc0'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihgfedcbazyxwvutsr', '0x20', '5137d9140b803ef7'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihgfedcbazyxwvutsrq', '0x20', '4ffb60d121e976a1'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihgfedcbazyxwvutsrqp', '0x20', 'a2fb46d487fd98c3'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihgfedcbazyxwvutsrqpo', '0x20', '867f790518177aec'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihgfedcbazyxwvutsrqpon', '0x20', '54ef5e360e089c7c'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihgfedcbazyxwvutsrqponm', '0x20', '730157607530d189'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihgfedcbazyxwvutsrqponml', '0x20', '3a8a34e1477268ec'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihgfedcbazyxwvutsrqponmlk', '0x20', 'bc9112c487109513'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihgfedcbazyxwvutsrqponmlkj', '0x20', 'de9cc08e048f1118'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihgfedcbazyxwvutsrqponmlkji', '0x20', '8bb9a7e8f47a1675'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihgfedcbazyxwvutsrqponmlkjih', '0x20', '0ff8a6016b70d4ad'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihgfedcbazyxwvutsrqponmlkjihg', '0x20', '2bc93a153dfaa122'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihgfedcbazyxwvutsrqponmlkjihgf', '0x20', '8bfcaf0deebe9024'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihgfedcbazyxwvutsrqponmlkjihgfe', '0x20', '4cf9aebeaa601980'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihgfedcbazyxwvutsrqponmlkjihgfed', '0x20', '7950029b1e41b71d'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihgfedcbazyxwvutsrqponmlkjihgfedc', '0x20', '88506d4614cb4d93'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihgfedcbazyxwvutsrqponmlkjihgfedcb', '0x20', '0c27b7b29d0e4a80'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihgfedcbazyxwvutsrqponmlkjihgfedcba', '0x20', '258ae8538519d49e'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihgfedcbazyxwvutsrqponmlkjihgfedcbaz', '0x20', 'bf156ec6cfd44860'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihgfedcbazyxwvutsrqponmlkjihgfedcbazy', '0x20', '4cfff2d9b25a8442'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihgfedcbazyxwvutsrqponmlkjihgfedcbazyx', '0x20', 'f4d6df330bfdeb1e'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihgfedcbazyxwvutsrqponmlkjihgfedcbazyxw', '0x20', '1902f8bd921105a4'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihgfedcbazyxwvutsrqponmlkjihgfedcbazyxwv', '0x20', 'cbe938ae66e976b4'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihgfedcbazyxwvutsrqponmlkjihgfedcbazyxwvu', '0x20', 'b4429ca298837c29'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihgfedcbazyxwvutsrqponmlkjihgfedcbazyxwvut', '0x20', 'ee101afa0fb6b82b'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihgfedcbazyxwvutsrqponmlkjihgfedcbazyxwvuts', '0x20', '3e705de35558c446'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihgfedcbazyxwvutsrqponmlkjihgfedcbazyxwvutsr', '0x20', '385da744bb20960f'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihgfedcbazyxwvutsrqponmlkjihgfedcbazyxwvutsrq', '0x20', '68a63a60c52f5291'],
            ['012345678901234567890123456789012345678912345678zyxwvutsrqponmlk012345678901234567890123456789012345678912345678zyxwvutsrqponmlkzyxwvutsrqponmlkjihgfedcbazyxwvutsrqponmlkjihgfedcbazyxwvutsrqp', '0x20', 'bd873d7d970b8667'],
        ];
    }

    /**
     * @covers ::final
     * @covers \N189900\Wyhash\Exception\AlreadyFinalizedException
     */
    public function testNoDoubleFinalize(): void
    {
        $state = new State();

        $this->assertNotEmpty($state->final(''));

        $this->expectException(AlreadyFinalizedException::class);
        $state->final('');
    }

    /**
     * @covers ::update
     * @covers \N189900\Wyhash\Exception\AlreadyFinalizedException
     */
    public function testNoUpdateAfterFinalize(): void
    {
        $state = new State();

        $this->assertNotEmpty($state->final(''));

        $this->expectException(AlreadyFinalizedException::class);
        $state->update('');
    }
}
